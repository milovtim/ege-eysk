buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath "com.monochromeroad.gradle-plugins:gradle-aws-s3-sync:0.5"
    }
}

import com.monochromeroad.gradle.plugin.aws.s3.S3Sync

ext {
    aws = [access: 'AKIAIV6TWXRXNOLRQN6A', secret: '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']
}

task deploy(type: S3Sync) {
    description = "Deploys Repetitor bucket"

    accessKey aws.access
    secretKey aws.secret

    configFile "synchronizer.properties"

    from "site/main"
    into "ege-eysk.ru"

    acl com.monochromeroad.gradle.plugin.aws.s3.ACL.PublicRead
}

task reviewsHtml << {
    ant.xslt(
            in: file('project/reviews/reviews.xml'),
            style: file('project/reviews/reviews.xsl'),
            out: file('project/reviews/reviews.html')
    )
//    def reviewDivs = new XmlParser(false, false).parse(file('project/reviews/reviews.html'))
//    int i = 0
//    def result = reviewDivs.div.collectEntries {div -> ["review${i++}": div.text()] }
//    println result
//    new groovy.text.SimpleTemplateEngine().createTemplate(file('project/index.htm'))
}